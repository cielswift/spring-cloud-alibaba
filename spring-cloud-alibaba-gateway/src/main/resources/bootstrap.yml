server:
  port: 5210
  servlet:
    context-path: /gateway
spring:
  application:
    name: gateway
  aop:
    proxy-target-class: true #使用cglib代理
  main:
    allow-bean-definition-overriding: true #bean冲突覆盖
  cloud:
    nacos:  #使用nacos注册中心
      discovery:
        server-addr: 127.0.0.1:13100,127.0.0.1:13101,127.0.0.1:13102
        namespace: a998603d-3546-4ddc-9099-2ed82a6f3a68 #开发环境
        group: DEFAULT_GROUP #组
      config:
        server-addr: 127.0.0.1:13100,127.0.0.1:13101,127.0.0.1:13102
        file-extension: yaml  #指定读取的配置文件后缀, dataId 默认就是spring.application.name + yaml, 可以通过prefix修改
        namespace: a998603d-3546-4ddc-9099-2ed82a6f3a68 #开发环境
        group: DEFAULT_GROUP #组
        prefix: gateway #文件名 -- 如果没有配置则默认为 ${spring.appliction.name} (优先级高)
        extension-configs:  #扩展配置,多个配置文件
          - dataId: xiapeixin.yaml
            group: DEFAULT_GROUP
            refresh: false
          - dataId: xiapeixin2.yaml
            group: DEFAULT_GROUP
            refresh: false

    gateway:  #路由规则
      discovery:
        locator:
          enabled: true
      routes:
        - id: consumer #id 任意
          uri: lb://consumer
          predicates:
            - Path=/con/**  #请求路径带有这个,那么映射到上面uri的服务上
          filters:
            - StripPrefix=1 #访问路径 http://127.0.0.1:5210/gateway/con/consumer/d1?name=xia

    sentinel: #限流
      transport:
        dashboard: 127.0.0.1:8080

  zipkin:  #链路追踪
    base-url: http://127.0.0.1:9411/
  sleuth:
    sampler:
      probability: 1 #percentage是采样比例

ribbon:
  ReadTimeout: 5000
  ConnectTimeout: 5000

feign:
  hystrix:
    enabled: true

#禁止超时时间
hystrix:
  command:
    default:
      execution:
        timeout:
          enable: false

management:
  endpoints:
    web:
      exposure:
        include: '*'

logging:
  config: classpath:logback-spring.xml
